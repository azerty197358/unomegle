<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SparkChat</title>

  <style>
/* ======================== */
/*   MOBILE FIRST LAYOUT   */
/* ======================== */

:root {
  --blue:#2ea3ff;
  --dark:#111;
  --light:#ffffff;
  --border:#e6d7c8;
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family:Arial, Helvetica, sans-serif;
  background:#fff;
  height:100vh;
  overflow:hidden;
  display:flex;
  flex-direction:column;
}

/* ========== TOP BAR ========== */
.topbar {
  height:55px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:0 12px;
  border-bottom:1px solid #eee;
  flex-shrink:0;
}

.logo { font-size:22px; font-weight:bold; color:#ff9a00; }
.logo span { color:#3fa0ff; }

#exitBtn {
  padding:8px 12px;
  font-size:14px;
  background:red;
  color:#fff;
  border:none;
  border-radius:6px;
}

/* ========== MAIN STAGE (FULL SCREEN) ========== */
.stage {
  flex:1;
  display:flex;
  flex-direction:column;
  gap:6px;
  padding:6px;
  overflow:hidden;
}

/* ========== VIDEO AREA ========== */
.left-col {
  width:100%;
  display:flex;
  flex-direction:column;
  gap:6px;
  flex:1;
  min-height:0;
}

/* Each video gets half screen height */
.video-frame {
  position:relative;
  border-radius:10px;
  border:4px solid var(--border);
  overflow:hidden;
  background:#000;
  flex:1;
  min-height:0;
}

video {
  width:100%;
  height:100%;
  object-fit:cover;
}

.watermark {
  position:absolute;
  bottom:8px;
  left:8px;
  font-size:14px;
  color:#ffffffaa;
}

.video-label {
  position:absolute;
  top:6px;
  left:6px;
  font-size:11px;
  background:#fff;
  padding:3px 8px;
  border-radius:6px;
}

/* Icon buttons (mic + report) */
#reportBtn,
#micBtn {
  position:absolute;
  bottom:8px;
  right:8px;
  padding:8px 10px;
  font-size:15px;
  border-radius:50%;
  border:none;
  color:#fff;
  z-index:20;
}

#reportBtn { background:red; }
#micBtn    { background:#2ea3ff; }

/* ========== CHAT AREA (BOTTOM) ========== */
.right-col {
  width:100%;
  border:4px solid var(--border);
  border-radius:10px;
  background:#fff;
  display:flex;
  flex-direction:column;
  flex-shrink:0;
  max-height:38%;
  min-height:160px;
}

.chat-area {
  flex:1;
  overflow-y:auto;
  padding:8px;
}

.chat-input-row {
  padding:8px;
  display:flex;
  flex-direction:column;
  gap:6px;
}

.row-buttons {
  display:flex;
  gap:6px;
}

button {
  padding:10px;
  font-size:14px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

#startBtn { background:#2ea3ff; color:#fff; flex:1; }
#skipBtn  { background:#ff9a00; color:#fff; flex:1; }
#stopBtn  { background:#ccc; color:#111; flex:1; }

#sendBtn  { background:#2ea3ff; color:#fff; width:100%; }
#chatInput { padding:10px; border-radius:6px; border:1px solid #ccc; }

/* ======================== */
/*  SMALL SCREENS OPTIMIZE  */
/* ======================== */

@media (max-height: 700px) {
  .right-col { max-height:42%; }
}

@media (max-height: 600px) {
  .right-col { max-height:48%; }
}

@media (max-height: 520px) {
  .right-col { display:none; } /* Auto-hide chat on tiny phones */
}
  </style>

</head>

<body>

<!-- ===================== -->
<!--       TOP BAR         -->
<!-- ===================== -->
<div class="topbar">
  <div class="logo">Spark<span>Chat</span></div>
  <button id="exitBtn">Exit</button>
</div>

<!-- ===================== -->
<!--       MAIN AREA       -->
<!-- ===================== -->
<div class="stage">

  <div class="left-col">

    <!-- Stranger -->
    <div class="video-frame">
      <button id="reportBtn">üö®</button>
      <div class="watermark">SparkChat</div>
      <div class="video-label">Stranger</div>
      <video id="remoteVideo" autoplay playsinline></video>
      <div id="remoteSpinner"></div>
    </div>

    <!-- You -->
    <div class="video-frame">
      <button id="micBtn">üé§</button>
      <div class="watermark">SparkChat</div>
      <div class="video-label">You</div>
      <video id="localVideo" autoplay muted playsinline></video>
      <div id="localSpinner"></div>
    </div>

  </div>

  <!-- CHAT AREA -->
  <div class="right-col">
    <div id="chatMessages" class="chat-area">
      <div class="warning-msg">
        ‚ö†Ô∏è ÿßŸÑÿ±ÿ¨ÿßÿ° ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫ ŸÅŸàÿ±ÿßŸã ÿπŸÜ ÿ£Ÿä ÿ¥ÿÆÿµ ŸäŸÇŸàŸÖ ÿ®ÿ≠ÿ±ŸÉÿßÿ™ ÿ•ÿ®ÿßÿ≠Ÿäÿ© ÿ£Ÿà ÿ∫Ÿäÿ± ŸÑÿßÿ¶ŸÇÿ©.
      </div>
      <div class="msg system">Click "Start" to begin.</div>
    </div>

    <div class="chat-input-row">
      <div id="status">Ready</div>

      <div class="row-buttons">
        <button id="startBtn">Start</button>
        <button id="skipBtn">Skip</button>
        <button id="stopBtn">Stop</button>
      </div>

      <input id="chatInput" placeholder="Type.." disabled />
      <button id="sendBtn" disabled>Send</button>
    </div>
  </div>
</div>

<!-- ===================== -->
<!--       SCRIPTS         -->
<!-- ===================== -->
<script>
document.getElementById("exitBtn").onclick = () => location.href="index.html";

document.getElementById("reportBtn").onclick = async () => {
    try {
        await captureReport();
        alert("ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ®ŸÑÿßÿ∫ ÿ®ŸÜÿ¨ÿßÿ≠");
    } catch (e) {
        alert("ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫");
    }
};
</script>

<script src="/socket.io/socket.io.js"></script>
<script src="script.js"></script>

</body>
</html>
