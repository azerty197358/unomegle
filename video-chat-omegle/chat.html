<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SparkChat</title>

<style>
:root{
  --blue:#2ea3ff;
  --dark:#111;
  --light:#ffffff;
  --border:#e6d7c8;
  --gap:10px;
  --radius:12px;

  --bg:#ffffff;
  --text:#000;

  --msgYou:#cceaff;
  --msgStranger:#ffd8b0;
  --msgSystem:#e8e8e8;
}

.dark{
  --bg:#0f1115;
  --text:#f5f5f5;
  --msgYou:#1c2733;
  --msgStranger:#332519;
  --msgSystem:#222;
  --border:#444;
}

*{margin:0;padding:0;box-sizing:border-box;}
html, body{height:100%;overflow:hidden;font-family:Arial, sans-serif;background:var(--bg);color:var(--text)}

/* Ø§Ù„Ø´Ø¹Ø§Ø± */
.logo{
  font-size:48px;
  font-weight:bold;
  color:#ff9a00;
  display:flex;
  gap:4px;
}
.logo span{color:#3fa0ff;}

.flip-char{display:inline-block;transition:transform 0.8s ease;transform-origin: bottom;}
.flip{transform:rotateX(360deg);}

/* TOP BAR */
.topbar{
  height:60px;display:flex;justify-content:space-between;align-items:center;
  padding:0 12px;border-bottom:1px solid #ddd;background:var(--bg);
}

#exitBtn{background:red;color:#fff;padding:8px 12px;border:none;border-radius:8px;font-weight:bold;cursor:pointer;}
#darkToggle{
  background:#444;color:#fff;border:none;padding:8px 12px;border-radius:8px;
  cursor:pointer;margin-right:10px;
}

/* Notification */
.notify-box{position:relative;margin-right:12px;cursor:pointer;}
#notifyIcon{font-size:24px;}
#notifyDot{
  width:10px;height:10px;background:red;border-radius:50%;
  position:absolute;top:0;right:0;display:none;
}
#notifyMenu{
  position:absolute;right:0;top:40px;width:220px;
  background:#fff;border:1px solid #ccc;border-radius:8px;
  display:none;max-height:250px;overflow-y:auto;z-index:999;
}
.notify-item{padding:10px;border-bottom:1px solid #ddd;font-size:14px;}
.notify-empty{padding:10px;text-align:center;color:#777;}

/* ØµÙØ­Ø© */
.stage{
  position:absolute;top:60px;bottom:0;left:0;right:0;
  display:flex;gap:var(--gap);padding:12px;overflow:hidden;
}

/* CAMERAS */
.video-frame{
  position:relative;border-radius:var(--radius);
  border:6px solid var(--border);overflow:hidden;background:#000;
  display:flex;justify-content:center;align-items:center;
}

.video-label{
  position:absolute;top:8px;right:8px;background:#fff;
  padding:4px 10px;border-radius:6px;z-index:6;
}

.watermark{
  position:absolute;bottom:6px;left:6px;font-size:14px;
  color:#ffffffaa;font-weight:bold;z-index:6;
}

video{
  width:100%;height:100%;object-fit:cover;position:relative;z-index:0;
}

/* Ø²Ø± Ø§Ù„Ù…Ø§ÙŠÙƒ */
#micBtn{
  position:absolute;background:#2ea3ff;color:#fff;
  width:42px;height:42px;border-radius:50%;border:none;
  display:flex;justify-content:center;align-items:center;
  z-index:999;font-size:20px;cursor:pointer;
}

/* Ø²Ø± Ø§Ù„Ø¥Ø¨Ù„Ø§Øº */
#reportBtn{
  position:absolute;top:10px;right:10px;
  width:38px;height:38px;background:red;color:#fff;border:none;
  border-radius:50%;font-size:14px;cursor:pointer;z-index:10;
}

/* ===== MOBILE ===== */
@media(max-width:768px){

  /* Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø­Ù„ÙŠ Ø­Ø±Ù‘Ø© ÙÙˆÙ‚ Ø§Ù„ØµÙØ­Ø© */
  #localVideo{
    position:fixed !important;
    width:130px !important;
    height:170px !important;
    bottom:20px;
    right:20px;
    border-radius:10px;
    border:3px solid #fff;
    z-index:9999;
    touch-action:none;
  }

  /* Ø§Ù„Ø´Ø¹Ø§Ø± Ø¯Ø§Ø®Ù„ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø­Ù„ÙŠ */
  #localFrame .watermark{
    position:absolute;
    bottom:6px;
    right:6px;
    font-size:13px;
    z-index:99999;
  }

  /* Ø²Ø± Ø§Ù„Ù…Ø§ÙŠÙƒ Ø¯Ø§Ø®Ù„ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø­Ù„ÙŠ */
  #micBtn{
    position:fixed !important;
    bottom:25px !important;
    right:25px !important;
    z-index:10000 !important;
  }
}
</style>
</head>

<body>

<div class="topbar">
  <div class="logo" id="logo"></div>
  <div style="display:flex;gap:14px;align-items:center;">
    <button id="darkToggle">ğŸŒ™</button>
    <button id="exitBtn">Exit</button>
  </div>
</div>

<div class="stage">

  <div class="video-frame" id="remoteFrame">
    <button id="reportBtn">ğŸš¨</button>
    <div class="watermark">SparkChat</div>
    <div class="video-label">Stranger</div>
    <video id="remoteVideo" autoplay playsinline></video>
  </div>

  <div class="video-frame" id="localFrame">
    <button id="micBtn">ğŸ¤</button>
    <div class="watermark">SparkChat</div>
    <div class="video-label">You</div>
    <video id="localVideo" autoplay playsinline muted></video>
  </div>

</div>

<script src="/socket.io/socket.io.js"></script>
<script src="script.js"></script>

<script>
/* Ø³Ø­Ø¨ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø­Ù„ÙŠ ÙÙˆÙ‚ Ø§Ù„ØµÙØ­Ø© ÙƒØ§Ù…Ù„Ø© */
(function(){

  const local=document.getElementById("localVideo");

  let dragging=false,startX=0,startY=0,origX=0,origY=0;

  local.addEventListener("pointerdown",(e)=>{
    if(!window.matchMedia("(max-width:768px)").matches) return;

    dragging=true;
    local.setPointerCapture(e.pointerId);

    const rect=local.getBoundingClientRect();
    origX=rect.left;
    origY=rect.top;

    startX=e.clientX;
    startY=e.clientY;
  });

  local.addEventListener("pointermove",(e)=>{
    if(!dragging) return;

    let dx=e.clientX-startX;
    let dy=e.clientY-startY;

    let newX=origX+dx;
    let newY=origY+dy;

    const maxX=window.innerWidth-140;
    const maxY=window.innerHeight-180;

    newX=Math.max(0,Math.min(newX,maxX));
    newY=Math.max(0,Math.min(newY,maxY));

    local.style.left=newX+"px";
    local.style.top=newY+"px";
  });

  local.addEventListener("pointerup",()=>dragging=false);
  local.addEventListener("pointercancel",()=>dragging=false);

})();
</script>

</body>
</html>
